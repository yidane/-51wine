<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>门票预订</title>
    <link rel="stylesheet" href="../Styles/TicketList.css" />
    <link href="../styles/swiper.min.css" rel="stylesheet" />
    <script src="../javaScripts/zepto.min.js"></script>
    <script src="../javaScripts/knockout-3.3.0.js"></script>
</head>
<body>
    <div class="container">
        <ul class="tab-navs">
            <li class="active">全部</li>
            <li>门票</li>
            <li>车票</li>
        </ul>
        <div id="tabs-container" class="swiper-container tabs-container">
            <div class="swiper-wrapper" data-bind='foreach: Data'>
                <div class="swiper-slide">
                    <ul class="ticket-list" data-bind='foreach: content'>
                        <!-- ko if: canUse === false -->
                        <li>
                            <div class="ticket-detail" data-bind="style:{backgroundImage:image}">
                                <span class="title">
                                    <!--ko text: ticketName-->
                                    <!--/ko-->
                                    <span class="price">
                                        <!--ko text: price-->
                                        <!--/ko-->元
                                    </span>
                                </span>
                                <span class="recommend"></span>
                            </div>
                            <div class="tip"><span>敬请期待</span></div>
                        </li>
                        <!-- /ko -->
                        <!-- ko if: canUse === true -->
                        <li data-bind="style:{backgroundImage:image}">
                            <a data-bind="attr: { 'href': 'TicketDetail.html?ticketid=' + ticketCategoryId + '&ticketName=' + ticketName + '&price=' + price+'&code='+$root.access_code }">
                                <div class="ticket-detail">
                                    <span class="title">
                                        <!--ko text: ticketName-->
                                        <!--/ko-->
                                    </span>
                                    <span class="price">
                                        <!--ko text: price-->
                                        <!--/ko-->元
                                    </span>
                                </div>
                                <span class="recommend"></span>
                            </a>
                        </li>
                        <!-- /ko -->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <script src="../js/oAuth2.js"></script>
    <script src="../javaScripts/swiper.min.js"></script>
    <script>
        $(function () {

            loadTicket();
        });
    </script>
    <script type="text/javascript">
        function loadTicket() {
            $.ajax({
                type: "post",
                url: '../WebService/OrderWebService.asmx/TicketCategoryList',
                dataType: 'json',
                success: function (result) {
                    if (result.IsSuccess) {

                        result.access_code = getCode();
                        ko.applyBindings(result);
                        initSwiper();
                    } else {
                        alert(result.Message);
                    }
                }
            });
        }

        function initSwiper() {
            var tabsSwiper = new Swiper('.swiper-container', {
                speed: 500,
                onSlideChangeStart: function () {
                    $(".tab-navs li.active").removeClass('active');
                    $(".tab-navs li").eq(tabsSwiper.activeIndex).addClass('active');
                },
                onSlideChangeEnd: function (swiper) {
                    var scrollingElement = document.documentElement;
                    if (document.scrollingElement) {
                        scrollingElement = document.scrollingElement;
                    }
                    scrollingElement.scrollTop = 0;
                }
            });

            $(".tab-navs a").on('touchstart mousedown', function (e) {
                e.preventDefault();
                $(".tab-navs .active").removeClass('active');
                $(this).addClass('active');
                tabsSwiper.slideTo($(this).index());
            });
            $(".tab-navs a").click(function (e) {
                e.preventDefault();
            });
        }

        function getCode() {
            return access_code;
        }
    </script>
</body>
</html>
